<!DOCTYPE html>
<html lang="en">

<head>
    <title>Pentester Approval</title>
    <?php include "../inc/head.inc.php"; ?>
</head> 

<body>
    <?php include "../inc/header.inc.php"; ?> 

    <?php
    session_start();
   
    include "../inc/navadmin.inc.php";
    include "../processes/approval_of_pentester/query.php";

    // Display success message
    if (isset($_SESSION['success'])) {
        $successMsg = $_SESSION['success'];
        unset($_SESSION['success']); 

        echo "<div class='alert alert-success alert-dismissible fade show' role='alert'>" . htmlspecialchars($successMsg) . "<button type='button' class='btn-close' data-bs-dismiss='alert' aria-label='Close'></button>" . "</div>";
    } 
    ?>
     
    <main class="container mt-4">
        <h2>Pentester Approval</h2>
        <table class="table">
            <thead>
                <tr>
                    <th>Username</th>
                    <th>Full Name</th>
                    <th>Resume</th>
                    <th>Certification</th>
                    <th>Status</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <?php while($row = $result->fetch_assoc()): ?>
                    <tr class="<?php echo $row['approvalStatus'] == 'Rejected' ? 'table-secondary' : ''; ?>">
                        <td><?php echo htmlspecialchars($row['Username']); ?></td>
                        <td><?php echo htmlspecialchars($row['FullName']); ?></td>
                        <td><a href="../processes/approval_of_pentester/download.php?type=resume&id=<?php echo $row['PentesterID']; ?>" class="btn btn-link btn-sm">Download Resume</a></td>
                        <td><a href="../processes/approval_of_pentester/download.php?type=cert&id=<?php echo $row['PentesterID']; ?>" class="btn btn-link btn-sm">Download Certification</a></td>                    
                        <td><?php echo htmlspecialchars($row['approvalStatus']); ?></td>
                        <td>
                            <?php if($row['approvalStatus'] == 'Pending'): ?>
                                <a href="approve.php?id=<?php echo $row['PentesterID']; ?>" class="btn btn-success btn-sm">Approve</a>
                                <a href="reject.php?id=<?php echo $row['PentesterID']; ?>" class="btn btn-danger btn-sm">Reject</a>
                            <?php elseif($row['approvalStatus'] == 'Approved'): ?>
                                <a href="suspend.php?id=<?php echo $row['PentesterID']; ?>" class="btn btn-warning btn-sm">Suspend</a>
                            <?php endif; ?>
                        </td>
                    </tr>
                <?php endwhile; ?>
            </tbody>
        </table>
    </main>     
    <?php include "../inc/footer.inc.php"; ?> 
</body> 

</html> 