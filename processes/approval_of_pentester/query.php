<?php
    session_start();

    include '../inc/db.php';

    // Query to get pentester info and their approval status
    $query = "
        SELECT
            um.UserID,
            um.Username,
            um.FullName,
            pt.PentesterID,
            pt.certFileName,
            pt.resumeFileName,
            apt.ApprovalStatus
        FROM UserMaster um
        JOIN Pentester pt ON um.UserID = pt.UserID
        LEFT JOIN ApprovalOfPentester apt ON pt.PentesterID = apt.PentesterID
        WHERE um.Role = 'Pentester'
        ORDER BY FIELD(apt.ApprovalStatus, 'Pending', 'Approved', 'Rejected', 'Suspended'), um.Username ASC
    ";

    $result = $conn->query($query);

    $conn->close();
?>